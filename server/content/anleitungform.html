<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="/style.css">
    <link rel="shortcut icon" href="/favicon.png" type="image/x-icon">
    <title>Anleitung | blnet App</title>
</head>
<body>
    <main>
<h1>Anleitung - Sheetlink und Scriptlinks bekommen</h1>
<p>Diese beiden Links sind nötig, um das Notenformular einwandfrei benutzen zu können. Öffnen Sie zuerst das <a href="/manage">Management-Interface</a> und loggen Sie sich mit den Daten ein.</p>
<h2>Sheetlink</h2>
<p>Den Sheetlink bekommen ist einfach: Sie müssen das Spreadsheet-Dokument vom existierenden Notenformular öffnen und den Link kopieren. Den Link müssen Sie jedoch bearbeiten:</p>
<img class="tutorial" src="sheetlinkedit.PNG" alt="Sheetlink">
<p>Den gelb markierten Teil müssen Sie entfernen. Diesen Link können Sie dann im Management-Interface einfügen.</p>
<h3>Scriptlink</h3>
<p>Beim Scriptlink wird es ein bisschen schwieriger. Dafür müssen Sie das Google Spreadsheet-Dokument (Sheetlink) öffnen. Dann klicken Sie auf "Tools" und dann auf "Skripteditor"</p>
<img src="scriptlink1.png" alt="Scriptlink Step 1">
<p>Jetzt müsste eine neue Seite geöffnet sein. Hier müssen Sie jetzt den folgenden Code einfügen und den vorhandenen löschen. "SHEETLINKHIEREINFÜGEN" durch den Sheetlink des jeweiligen Users, der gerade eingerichtet wird, ersetzen.</p>
<div class="code">
    <code class="js">
        var ss = SpreadsheetApp.openByUrl("<strong>SHEETLINKHIEREINFÜGEN</strong>");<br/>
        <br/>
var sheet = ss.getSheetByName('Formularantworten'); // be very careful ... it is the sheet name .. so it should match <br/>
<br/>
<br/>
function doPost(e){<br/>
var action = e.parameter.action;<br/>
<br/>
if(action == 'addItem'){<br/>
  return addItem(e);<br/>
  <br/>
}<br/>
<br/>
}<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
function addItem(e){<br/>
    <br/>
var date =  new Date();<br/>
<br/>
var datefromuser = e.parameter.datum;<br/>
<br/>
var fach = e.parameter.fach;<br/>
<br/>
var thema = e.parameter.themaPruefung;<br/>
<br/>
var notentyp = e.parameter.notenTyp;<br/>
<br/>
var note = e.parameter.note;<br/>
<br/>
var begruendung = e.parameter.begruendung;<br/>
<br/>
sheet.appendRow([date,datefromuser,fach,thema,notentyp,note,begruendung]);<br/>
<br/>
   return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);<br/>
   <br/>
   <br/>
   <br/>
}<br/>
    </code>
</div>
<p>Jetzt sollten Sie das Skript mit Strg+S speichern. Sie werden gefragt, dem File einen Namen zu geben. Wie Sie es nennen ist ihnen frei überlassen. Dann klicken Sie auf "Veröffentlichen" und dann auf "Als Web-App einrichten...".</p>
<img class="tutorial" src="scriptlink2.png" alt="Scriptlink Step 2">
<p>Jetzt wird ein Fenster erscheinen. Den Versionnamen können Sie nach ihren Belieben vergeben, der Rest sollte wie im Screenshot eingestellt werden. Dann auf "Deploy" klicken</p>
<img class="tutorial" src="scriptlink3.png" alt="Scriptlink Step 3">
<p>Der Link der jetzt erscheint, ist der Scriptlink.</p>
<img class="tutorial" src="scriptlink4.png" alt="Scriptlink Step 4">
<p>Diesen können Sie jetzt auch im Management-Interface eingeben. Jetzt können Sie auf "Hinzufügen" klicken.</p>
<img class="tutorial" src="scriptlink5.png" alt="Scriptlink Step 5">
</main>
</body>
</html>